From 40f37b877e2e9e7cede970940e7c9b27839eb501 Mon Sep 17 00:00:00 2001
From: Pavel Kubelun <be.dissent@gmail.com>
Date: Mon, 4 Dec 2017 12:11:23 -0500
Subject: [PATCH 1/3] Revert "mt76x2: convert between per-chain tx power and
 combined output"

This reverts commit 19fff4133800fbfbc23cad2242d047b1e4c77ae7.
---
 mt76x2_init.c | 3 ---
 mt76x2_main.c | 7 -------
 2 files changed, 10 deletions(-)

diff --git a/mt76x2_init.c b/mt76x2_init.c
index 3e3a01b..0755b45 100644
--- a/mt76x2_init.c
+++ b/mt76x2_init.c
@@ -785,9 +785,6 @@ mt76x2_init_txpower(struct mt76x2_dev *dev,
 		chan->max_power = mt76x2_get_max_rate_power(&t) +
 				  target_power;
 		chan->max_power /= 2;
-
-		/* convert to combined output power on 2x2 devices */
-		chan->max_power += 3;
 	}
 }
 
diff --git a/mt76x2_main.c b/mt76x2_main.c
index c8338a3..d93b791 100644
--- a/mt76x2_main.c
+++ b/mt76x2_main.c
@@ -156,9 +156,6 @@ mt76x2_config(struct ieee80211_hw *hw, u32 changed)
 	if (changed & IEEE80211_CONF_CHANGE_POWER) {
 		dev->txpower_conf = hw->conf.power_level * 2;
 
-		/* convert to per-chain power for 2x2 devices */
-		dev->txpower_conf -= 6;
-
 		if (test_bit(MT76_STATE_RUNNING, &dev->mt76.state)) {
 			mt76x2_phy_set_txpower(dev);
 			mt76x2_tx_set_txpwr_auto(dev, dev->txpower_conf);
@@ -447,10 +444,6 @@ mt76x2_get_txpower(struct ieee80211_hw *hw, struct ieee80211_vif *vif, int *dbm)
 	struct mt76x2_dev *dev = hw->priv;
 
 	*dbm = dev->txpower_cur / 2;
-
-	/* convert from per-chain power to combined output on 2x2 devices */
-	*dbm += 3;
-
 	return 0;
 }
 
-- 
2.7.4

